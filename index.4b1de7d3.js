const t=new class{constructor(t=[]){t.length?this.initialState=t:this.initialState=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.board=[...this.initialState],this.score=0,this.status="idle"}getScore(){return this.score}getState(){return this.board}getStatus(){return this.status}start(){"playing"!==this.status&&(this.status="playing",this.board=this.initialState.map(t=>[...t]),this.score=0,this.addRandomTile(),this.addRandomTile(),this.updateUI(),this.listenForKeyPresses(),this.updateButtonToRestart(),this.hideMessages())}restart(){this.status="idle",this.board=this.initialState.map(t=>[...t]),this.score=0,this.updateUI(),this.updateButtonToStart(),this.hideMessages()}moveLeft(){if("playing"!==this.status)return;let t=!1;for(let e=0;e<4;e++){let s=[...this.board[e]],i=this.compressRow(s),r=this.mergeRow(i),o=this.compressRow(r);this.rowsEqual(s,o)||(this.board[e]=o,t=!0)}t&&(this.addRandomTile(),this.updateUI(),this.checkGameStatus())}moveRight(){if("playing"!==this.status)return;let t=!1;for(let e=0;e<4;e++){let s=[...this.board[e]],i=[...s].reverse(),r=this.compressRow(i),o=this.mergeRow(r),a=this.compressRow(o).reverse();this.rowsEqual(s,a)||(this.board[e]=a,t=!0)}t&&(this.addRandomTile(),this.updateUI(),this.checkGameStatus())}moveUp(){if("playing"!==this.status)return;let t=!1;for(let e=0;e<4;e++){let s=this.getColumn(e),i=this.compressRow(s),r=this.mergeRow(i),o=this.compressRow(r);this.rowsEqual(s,o)||(this.setColumn(e,o),t=!0)}t&&(this.addRandomTile(),this.updateUI(),this.checkGameStatus())}moveDown(){if("playing"!==this.status)return;let t=!1;for(let e=0;e<4;e++){let s=this.getColumn(e),i=[...s].reverse(),r=this.compressRow(i),o=this.mergeRow(r),a=this.compressRow(o).reverse();this.rowsEqual(s,a)||(this.setColumn(e,a),t=!0)}t&&(this.addRandomTile(),this.updateUI(),this.checkGameStatus())}compressRow(t){let e=t.filter(t=>0!==t);for(;e.length<4;)e.push(0);return e}mergeRow(t){let e=[...t];for(let t=0;t<3;t++)e[t]===e[t+1]&&0!==e[t]&&(e[t]*=2,this.score+=e[t],e[t+1]=0);return e}getColumn(t){let e=[];for(let s=0;s<4;s++)e.push(this.board[s][t]);return e}setColumn(t,e){for(let s=0;s<4;s++)this.board[s][t]=e[s]}rowsEqual(t,e){return t.every((t,s)=>t===e[s])}addRandomTile(){let t=[];for(let e=0;e<4;e++)for(let s=0;s<4;s++)0===this.board[e][s]&&t.push({row:e,col:s});if(0===t.length)return;let e=t[Math.floor(Math.random()*t.length)];this.board[e.row][e.col]=.9>Math.random()?2:4}checkGameStatus(){this.checkWin()?(this.status="win",this.displayMessage("win"),this.updateButtonToStart()):this.checkLose()&&(this.status="lose",this.displayMessage("lose"),this.updateButtonToStart())}checkWin(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(2048===this.board[t][e])return!0;return!1}checkLose(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(0===this.board[t][e]||e<3&&this.board[t][e]===this.board[t][e+1]||t<3&&this.board[t][e]===this.board[t+1][e])return!1;return!0}updateUI(){let t=document.querySelectorAll(".field-cell"),e=0;for(let s=0;s<4;s++)for(let i=0;i<4;i++){let r=this.board[s][i],o=t[e];o&&(o.textContent=0===r?"":r,o.className="field-cell",r&&o.classList.add(`field-cell--${r}`)),e++}let s=document.querySelector(".game-score");s&&(s.textContent=this.score)}listenForKeyPresses(){document.addEventListener("keydown",t=>{if("playing"===this.status)switch(t.key){case"ArrowLeft":this.moveLeft();break;case"ArrowRight":this.moveRight();break;case"ArrowUp":this.moveUp();break;case"ArrowDown":this.moveDown()}})}updateButtonToRestart(){let t=document.querySelector(".button");t&&(t.textContent="Restart",t.classList.remove("start"),t.classList.add("restart"),t.onclick=()=>this.restart())}updateButtonToStart(){let t=document.querySelector(".button");t&&(t.textContent="Start",t.classList.remove("restart"),t.classList.add("start"),t.onclick=()=>this.start())}displayMessage(t){let e=document.querySelector(".message-win"),s=document.querySelector(".message-lose");"win"===t&&e?e.classList.remove("hidden"):"lose"===t&&s&&s.classList.remove("hidden")}hideMessages(){let t=document.querySelector(".message-win"),e=document.querySelector(".message-lose"),s=document.querySelector(".message-start");t&&t.classList.add("hidden"),e&&e.classList.add("hidden"),s&&s.classList.add("hidden")}};document.addEventListener("DOMContentLoaded",function(){let e=document.querySelector(".button");e&&e.addEventListener("click",()=>{"idle"===t.getStatus()?t.start():"playing"===t.getStatus()&&t.restart()})});
//# sourceMappingURL=index.4b1de7d3.js.map
